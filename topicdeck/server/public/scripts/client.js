!function(){"use strict";function unescape(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}const templateSettings={evaluate:/\{\{(([^\}]+|\\.)+)\}\}/g,interpolate:/\{\{=\s*([^\}]+)\}\}/g,stream:/\{\{~\s*([^\}]+)\}\}/g,conditional:/\{\{\?(\?)?\s*([^\}]*)?\}\}/g,node:"object"==typeof process,varname:"it"},compile=function(e,t,n){t=Object.assign({},templateSettings,t);e="var P=Promise.resolve.bind(Promise);function* f(p,a,b){yield p.then(v=>(a=v?a:b)&&'');yield* (a||(_=>[]))();};var s = function(x) { return x.then(stream => (stream.constructor.name === 'StreamReader') ? sNode : sWhatWg )};var sWhatWg=rW=>{\nrW=rW.then(l=>l.getReader());\nvar d=!1;\nreturn i={next:_=>({done:d,value:rW.then(rW=>rW.read()).then(v=>{d=v.done; return P(v.value)})}),[Symbol.iterator]:_=>i};\n};var sNode=rN=>{\nvar d=!1,l,b=[];\nrN.then(rN=>{\nrN.on('end',_=>{d=!0;l&&l()});\nrN.on('data',c=>(l&&(v=>{var t=l;l=null;t(v)})||(d=>b.push(d)))(c));\n});\nreturn i={next:_=>({done:b.length===0&&d,value:P(b.shift()||new Promise(rN=>l=rN))}),[Symbol.iterator]:_=>i};};var g=function*(){yield P('"+e.replace(/'|\\/g,"\\$&").replace(t.interpolate,function(e,t){return"');yield P("+unescape(t)+");yield P('"}).replace(t.conditional,function(e,t,n){return n&&!t?"');yield* f(P("+unescape(n)+"),function*(){yield P('":!n&&t?"')},function*(){yield P('":"')});yield P('"}).replace(t.stream,function(e,t){return"');yield* sWhatWg(P("+unescape(t)+"));yield P('"}).replace(t.evaluate,function(e,t){return"');"+unescape(t)+";yield P('"}).replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")+"');}();",t.node?e+="var r = new R({read:function f() {\nvar d=g.next();\nif(d.done) return r.push(null);\nP(d.value).then(v=>{if(v)return r.push(Buffer.from(v));else f()});\n}});\nreturn r;\n":e+='var e=new TextEncoder();\nreturn new ReadableStream({\npull: c=>{\nvar v=g.next();\nif(v.done)return c.close();\nv.value.then(d=>{\nif(typeof(d)=="string")d=e.encode(d);\nd&&c.enqueue(d);\n});\nreturn v.value;\n}});';try{if(t.noEval)return e;if(t.node){const n=new Function(t.varname,"R",e);return e=>n(e,require("stream").Readable)}return new Function(t.varname,e)}catch(t){throw console.log("Could not create a template function: "+e),t}};let DOMParser=eval("window.DOMParser");const templatePath={};var loadTemplate=e=>e in templatePath?(console.log(`loading ${e} from cache`),templatePath[e].clone().body):caches$1.match(new Request(e)).then(t=>t||fetch$1(new Request(e))).then(t=>(templatePath[e]=t.clone(),t.body)),configCache={},loadData=e=>{if(e in configCache)return Promise.resolve(configCache[e].then(e=>e.clone()));const t=new Request(e),n=caches$1.open("data").then(n=>n.match(t.clone()).then(t=>{const r=fetch$1(e).then(t=>(n.put(e,t.clone()),t)).catch(e=>new Response("Not found.",{status:"404"}));return t||r}));return configCache[e]=n.then(e=>e.clone()),n};function compileTemplate(e){return console.log(`loading template ${e}`),loadTemplate(e).then(e=>streamToString(e)).then(e=>compile(e,{node:!1,evaluate:/\$\$(([^\$]+|\\.)+)\$\$/g}))}function streamToString(e){const t=e.getReader();let n,r,o=new Uint8Array;const a=new Promise((e,t)=>{n=e,r=t});return function e(){return t.read().then(({value:t,done:r})=>{if(r){const e=new TextDecoder;return n(e.decode(o))}let a=new Uint8Array(o.length+t.length);return a.set(o),a.set(t,o.length),o=a,e()},e=>r(e))}(),a}var fetch$1=eval("self.fetch"),WritableStream=eval("self.WritableStream"),ReadableStream=eval("self.ReadableStream"),Request=eval("self.Request"),Response=eval("self.Response"),caches$1=eval("self.caches");const parseUrl=e=>new URL(e.url).searchParams.get("url"),getProxyUrl=e=>e.url,getProxyHeaders=e=>({}),paths={assetPath:"/assets/",dataPath:"/data/"},cacheStorage={},proxyShouldHitNetwork=!0;var common=Object.freeze({compileTemplate:compileTemplate,loadTemplate:loadTemplate,loadData:loadData,streamToString:streamToString,DOMParser:DOMParser,WritableStream:WritableStream,ReadableStream:ReadableStream,Request:Request,Response:Response,fetch:fetch$1,caches:caches$1,cacheStorage:cacheStorage,parseUrl:parseUrl,getProxyUrl:getProxyUrl,getProxyHeaders:getProxyHeaders,proxyShouldHitNetwork:proxyShouldHitNetwork,paths:paths});const compileTemplate$1=compileTemplate,CommonDOMParser=DOMParser,findNode=(e,t)=>{let n;for(let r=0;r<t.length;r++)if((n=t[r]).tagName==e)return n},findNodes=(e,t)=>{const n=[];let r;for(let o=0;o<t.length;o++)(r=t[o]).tagName==e&&n.push(r);return n},hardSanitize=(e,t)=>{t=t||100;let n=!1;const r=[];for(let o of e){if(r.length>t)break;"<"!=o?">"!=o||1!=n?"\n"!=o&&"\r"!=o&&(n||r.push(o)):n=!1:n=!0}return r.join("")},findElementText=(e,t)=>{const n=findNodes(e,t.childNodes);return n&&n.length>0?n[0].textContent:""},findElementAttribute=(e,t,n)=>{const r=findNodes(e,n.childNodes);if(r&&r.length>0){const e=r[0].attributes.getNamedItem(t);return void 0!==e?e.value:""}return""},attributeEquals=(e,t)=>n=>{const r=n.attributes.getNamedItem(e);return r&&r.value===t},convertFeedItemsToJSON=e=>{if(void 0===e)return[];const t=(new CommonDOMParser).parseFromString(e,"application/xml").documentElement,n={};if(null===t)return[];if("rss"===t.nodeName){const e=findNode("channel",t.childNodes),r=findElementText("title",e),o=findElementText("link",e),a=findNodes("item",e.childNodes);return n.title=r,n.link=o,a.map(e=>convertRSSItemToJSON(e,n))}if("feed"===t.nodeName){const e=findNodes("entry",t.childNodes),r=findElementText("title",t),o="";findNodes("link",t).filter(attributeEquals("rel","self"))[0];return n.title=r,n.link=o,e.map(e=>convertAtomItemToJSON(e,n))}return[]},convertAtomItemToJSON=(e,t)=>{const n=findElementText("title",e),r=findElementText("summary",e),o=findElementText("id",e),a=findElementText("updated",e),l=findElementText("author",e)||findElementText("dc:creator",e)||t.title,i=findElementAttribute("link","href",e);return{title:hardSanitize(n,400),guid:o,description:hardSanitize(r,100),pubDate:a,author:l,link:i}},convertRSSItemToJSON=(e,t)=>{const n=findElementText("title",e),r=findElementText("description",e),o=findElementText("guid",e),a=findElementText("pubDate",e)||findElementText("a10:updated",e),l=findElementText("author",e)||findElementText("dc:creator",e)||t.title,i=findElementText("link",e),s=findElementText("content:encoded",e);return{title:hardSanitize(n,400),guid:o,description:hardSanitize(r,100),"content:encoded":hardSanitize(s,100),pubDate:a,author:l,link:i}};!function(){if("serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})}),"BroadcastChannel"in window){new BroadcastChannel("install-cache-channel").onmessage=(e=>{console.log(e);const t=document.getElementById("toast");t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),1e4)})}const e=(e,t)=>{const n=e.content.cloneNode(!0),r=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,()=>NodeFilter.FILTER_ACCEPT);for(;r.nextNode();){const e=r.currentNode;for(const n in e.dataset){if(0==n.indexOf("bind_")){const r=e.dataset[n].split("|"),o=n.substr(5);for(const n of r)if(n in t&&""!==t[n]){e[o]=t[n];break}}}}return n};!function(e,t){const n=document.querySelectorAll(e);n&&t(Array.prototype.slice.call(n)),new MutationObserver(function(n){n.forEach(function(n){let r=Array.prototype.slice.call(n.addedNodes),o=[];for(let t of r)t.matches&&1==t.nodeType&&t.matches(e)&&o.push(t);t(o)})}).observe(document.documentElement,{childList:!0,subtree:!0})}("section div[data-url]",t=>{const n=document.getElementById("itemTemplate");for(const r of t){const t=r.dataset.url,o=`/proxy?url=${encodeURIComponent(t)}`;fetch(o).then(e=>{const t=e.clone();return"caches"in window?caches.open("data").then(n=>(n&&n.put(o,t),e.text())):e.text()}).then(e=>convertFeedItemsToJSON(e)).then(e=>e.reverse()).then(e=>e.filter(e=>!document.getElementById(e.guid))).then(t=>t.map(t=>e(n.cloneNode(!0),t))).then(e=>e.forEach(e=>r.insertBefore(e,r.firstChild)))}}),document.addEventListener("click",e=>{const t=e.target;if("svg"===t.nodeName&&t.classList.contains("share")){e.preventDefault();const n=t.getAttribute("url")||"",r=t.getAttribute("title")||"";if(navigator.share)navigator.share({url:n,title:r,text:r});else{const e="scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=520,height=420",t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(r)}&url=${encodeURIComponent(n)}`;window.open(t,"intent",e)}}}),document.addEventListener("keyup",e=>{const t=document.querySelectorAll("section"),n=document.querySelector("section.selected");let r;"ArrowLeft"==e.code?!1==!!n?r=t[t.length-1]:(n.classList.remove("selected"),r=n.previousElementSibling?n.previousElementSibling:t[t.length-1]):"ArrowRight"==e.code&&(!1==!!n?r=t[0]:(n.classList.remove("selected"),r=n.nextElementSibling?n.nextElementSibling:t[0])),r&&(r.classList.add("selected"),r.scrollIntoView({behaviour:"smooth"}))})}()}();
